#!/bin/sh
#
# Pre-commit hook for pikru
#
# This hook regenerates comparison.html before each commit to ensure
# visual comparisons are always up-to-date with the current code.
#
# To install this hook, run:
#   cp scripts/pre-commit .git/hooks/pre-commit
#   chmod +x .git/hooks/pre-commit

echo "ğŸ”„ Regenerating visual comparison HTML..."

# Run the comparison generation
if cargo run --package xtask -- compare-html; then
    echo "âœ… Visual comparison HTML generated successfully"

    # Add the generated file to the current commit
    if git add comparison.html; then
        echo "âœ… Added comparison.html to commit"
    else
        echo "âš ï¸  Warning: Failed to add comparison.html to commit"
    fi
else
    echo "âŒ Failed to generate visual comparison HTML"
    echo "âŒ Commit aborted. Please fix the issues and try again."
    exit 1
fi

echo "ğŸš€ Pre-commit hook completed successfully"
